<htmlform formName="HMIS 122a HIV Care ART Card - Summary Form"
          formDescription="Summary entry form for patients enrolled for ART"
          formEncounterType="8d5b27bc-c2cc-11de-8d13-0010c6dffd0f"
          formUuid="52653a60-8300-4c13-be4d-4b746da06fee"
          formVersion="3.0"
          formAddMetadata="yes"
          formUILocation="patientDashboard.visitActions"
          formOrder="1"
          formIcon="icon-medkit"
          formShowIf="(visit.active || !visit.active) &amp;&amp; patient.person.dead==false &amp;&amp; sessionLocation.uuid=='86863db4-6101-4ecf-9a86-5e716d6504e4'"
          formDisplayStyle="Standard"
          formLabel="ART Card - Summary Form">
    <script type="text/javascript">

        beforeSubmit.push(function () {
            var submitVal = true;
            <!-- Validation rules -->
            <!-- The next appointment date if specified has to be after the encounterDate -->
            var message1 = "Must be after HIV enrolled date";
            var message2 = "Must be after Eligible date";
            var message3 = "Must be after Enrolled date";
            var message4 = "Must be earlier or on the same day as HIV enrolled";
            var message5 = "Must be after ART Start Date";
            var message6 = "Must be after ART Transfer Date";
            var message7 = "Either This or Art Transfer Date Must be filled if you have switching or substitution dates filled";
            var message8 = "Either This or Art Start Date Must be filled if you have switching or substitution dates filled";

            var submitValStage = [];
            var submitValStageART = [];

            //Validation for Substitution within 1st line
            submitValStageART.push(dateValidator("99163_1", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("99163_2", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("99163_3", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("99163_4", "99161", "99160", message5, message6, "less_than", false));

            //Validation for Switch to 2nd
            submitValStageART.push(dateValidator("99164_1", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("99164_2", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("99164_3", "99161", "99160", message5, message6, "less_than", false));

            //Validation for Switch to 3rd
            submitValStageART.push(dateValidator("162991_1", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("162991_2", "99161", "99160", message5, message6, "less_than", false));
            submitValStageART.push(dateValidator("162991_3", "99161", "99160", message5, message6, "less_than", false));

            submitValStage = submitValStageART;

            //Validation for Date Confirmed HIV +Ve
            submitValStage.push(dateValidator("90267", "encounterDate", "", message4, "", "greater_than", true));

            //Validation for Start ART date
            if (getValue("99161" + '.value') != "" &amp;&amp; getValue("99160" + '.value') == "") {
                submitValStage.push(dateValidator("99161", "90299", "encounterDate", message3, message1, "less_than", false));
            }
            //Validation for ART Transfer Date
            if (getValue("99160" + '.value') != "") {
                submitValStage.push(dateValidator("99160", "90299", "encounterDate", message3, message1, "less_than", false));
            }

            if (getValue("99160" + '.value') == "") {
                //Validation for Eligible and ready Date
                submitValStage.push(dateValidator("90299", "90297", "encounterDate", message2, message1, "less_than", false));
                //Validation for Eligible for ART Date
                submitValStage.push(dateValidator("90297", "encounterDate", "", message1, "", "less_than", true));
            }
            //Validation for Transfer out Date
            submitValStage.push(validateRequiredField("99165", "90306", "Can Not Be Null", "check_box"));
            //Validation for Lost to follow-up Date
            submitValStage.push(validateRequiredField("90209", "5240", "Can Not Be Null", "check_box"));

            if ((getValue("99161" + '.value') == "" &amp;&amp; getValue("99160" + '.value') == "") &amp;&amp; (submitValStageART.indexOf(false) != -1)) {
                getField("99161" + '.error').html(message7).show();
                getField("99160" + '.error').html(message8).show();
            }

            if (submitValStage.indexOf(false) != -1) {
                submitVal = false;
                jq().toastmessage('showErrorToast', "  There are errors during the validation of the data on the form. Please correct them and submit again");
            }

            return submitVal;
        });

        function enable_disable_ei_final_status(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="ExposedInfantFinalStatus"][class*="Children1"]';
            var row_2 = '[class^="ExposedInfantFinalStatus"][class*="Children2"]';
            var row_3 = '[class^="ExposedInfantFinalStatus"][class*="Children3"]';
            var row_4 = '[class^="ExposedInfantFinalStatus"][class*="Children4"]';
            var row_5 = '[class^="ExposedInfantFinalStatus"][class*="Children5"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find(":selected").text();

            if (selected_value.toLowerCase() == "p") {
                disable = false;
            }
            else {
                disable = true;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;
                case 5:
                    xx = row_5;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Children') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }

            });

        }

        function enable_disable_ei_pcr_result(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="ExposedInfantPCRResult"][class*="Children1"]';
            var row_2 = '[class^="ExposedInfantPCRResult"][class*="Children2"]';
            var row_3 = '[class^="ExposedInfantPCRResult"][class*="Children3"]';
            var row_4 = '[class^="ExposedInfantPCRResult"][class*="Children4"]';
            var row_5 = '[class^="ExposedInfantPCRResult"][class*="Children5"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find("input").val();

            if (selected_value != "") {
                disable = false;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;
                case 5:
                    xx = row_5;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Children') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);
                    group.find("select").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                        group.find("select").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                        group.find("select").fadeTo(250, 0.25);
                    }

                }
            });
        }


        function enable_disable_ac(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="ArtCare"][class*="Child1"]';
            var row_2 = '[class^="ArtCare"][class*="Child2"]';
            var row_3 = '[class^="ArtCare"][class*="Child3"]';
            var row_4 = '[class^="ArtCare"][class*="Child4"]';
            var row_5 = '[class^="ArtCare"][class*="Child5"]';
            var row_6 = '[class^="ArtCare"][class*="Child6"]';
            var row_7 = '[class^="ArtCare"][class*="Child7"]';
            var row_8 = '[class^="ArtCare"][class*="Child8"]';
            var row_9 = '[class^="ArtCare"][class*="Child9"]';
            var row_10 = '[class^="ArtCare"][class*="Child10"]';
            var row_11 = '[class^="ArtCare"][class*="Child11"]';
            var row_12 = '[class^="ArtCare"][class*="Child12"]';
            var row_13 = '[class^="ArtCare"][class*="Child13"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find(":selected").text();

            selected_value = selected_value.trim().toLowerCase();

            if (selected_value == "other" || selected_value == "other specify") {
                disable = false;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;
                case 5:
                    xx = row_5;
                    break;
                case 6:
                    xx = row_6;
                    break;
                case 7:
                    xx = row_7;
                    break;
                case 8:
                    xx = row_8;
                    break;
                case 9:
                    xx = row_9;
                    break;
                case 10:
                    xx = row_10;
                    break;
                case 11:
                    xx = row_11;
                    break;
                case 12:
                    xx = row_12;
                    break;
                case 13:
                    xx = row_13;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Child') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }
            });
        }


        function enable_disable_art_start(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="ARTStart"][class*="Child1"]';
            var row_2 = '[class^="ARTStart"][class*="Child2"]';
            var row_3 = '[class^="ARTStart"][class*="Child3"]';
            var row_4 = '[class^="ARTStart"][class*="Child4"]';
            var row_5 = '[class^="ARTStart"][class*="Child5"]';
            var row_6 = '[class^="ARTStart"][class*="Child6"]';
            var row_7 = '[class^="ARTStart"][class*="Child7"]';
            var row_8 = '[class^="ARTStart"][class*="Child8"]';
            var row_9 = '[class^="ARTStart"][class*="Child9"]';
            var row_10 = '[class^="ARTStart"][class*="Child10"]';
            var row_11 = '[class^="ARTStart"][class*="Child11"]';
            var row_12 = '[class^="ARTStart"][class*="Child12"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find("input[type=hidden]").val();

            if (selected_value != "") {
                disable = false;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;
                case 5:
                    xx = row_5;
                    break;
                case 6:
                    xx = row_6;
                    break;
                case 7:
                    xx = row_7;
                    break;
                case 8:
                    xx = row_8;
                    break;
                case 9:
                    xx = row_9;
                    break;
                case 10:
                    xx = row_10;
                    break;
                case 11:
                    xx = row_11;
                    break;
                case 12:
                    xx = row_12;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Child') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);
                    group.find("select").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }
            });
        }


        function enable_disable_art_start3(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="ARTStart3"][class*="Child1"]';
            var row_2 = '[class^="ARTStart3"][class*="Child2"]';
            var row_3 = '[class^="ARTStart3"][class*="Child3"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find("input[type=hidden]").val();

            if (selected_value != "") {
                disable = false;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Child') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);
                    group.find("select").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }
            });
        }


        function enable_disable_hiv_care(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;

            var row_1 = '[class^="HIVCare"][class*="Child1"]';
            var row_2 = '[class^="HIVCare"][class*="Child2"]';
            var row_3 = '[class^="HIVCare"][class*="Child3"]';
            var row_4 = '[class^="HIVCare"][class*="Child4"]';
            var row_5 = '[class^="HIVCare"][class*="Child5"]';
            var row_6 = '[class^="HIVCare"][class*="Child6"]';
            var row_7 = '[class^="HIVCare"][class*="Child7"]';
            var row_8 = '[class^="HIVCare"][class*="Child8"]';
            var row_9 = '[class^="HIVCare"][class*="Child9"]';
            var row_10 = '[class^="HIVCare"][class*="Child10"]';
            var row_11 = '[class^="HIVCare"][class*="Child11"]';
            var row_12 = '[class^="HIVCare"][class*="Child12"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find("input").val();

            selected_value = selected_value.trim().toLowerCase();

            if (selected_value != "") {
                disable = false;
            }

            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;
                case 5:
                    xx = row_5;
                    break;
                case 6:
                    xx = row_6;
                    break;
                case 7:
                    xx = row_7;
                    break;
                case 8:
                    xx = row_8;
                    break;
                case 9:
                    xx = row_9;
                    break;
                case 10:
                    xx = row_10;
                    break;
                case 11:
                    xx = row_11;
                    break;
                case 12:
                    xx = row_12;
                    break;
            }


            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Child') == -1) {
                    /* group.find("input").attr("value", "");*/
                    group.find("input").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }
            });
        }


        function enable_disable_ati(selected_option) {

            var class_name = jq(selected_option).attr("class");

            var length = class_name.length;

            var class_id = parseInt(class_name.substring(length - 1, length));

            var row_id = class_id;

            var disable = true;
            var disable2 = true;

            var row_1 = '[class^="ARTTreatmentInterruption"][class*="Child1"]';
            var row_2 = '[class^="ARTTreatmentInterruption"][class*="Child2"]';
            var row_3 = '[class^="ARTTreatmentInterruption"][class*="Child3"]';
            var row_4 = '[class^="ARTTreatmentInterruption"][class*="Child4"]';
            var row_5 = '[class^="ARTTreatmentInterruption"][class*="Child5"]';
            var row_6 = '[class^="ARTTreatmentInterruption"][class*="Child6"]';

            var xx = row_1;
            var selected_value = jq(selected_option).find(":selected").text();

            var selected_value2 = jq(selected_option).find("input[type=hidden]").val();

            selected_value = selected_value.trim().toLowerCase();

            if (selected_value == "stopped" || selected_value == "lost") {
                disable = false;
            }

            if (selected_value == "stopped") {
                disable2 = false;
            }

            if (selected_value == "" &amp;&amp; selected_value2 != "") {
                disable2 = false;
            }


            switch (row_id) {
                case 1:
                    xx = row_1;
                    break;
                case 2:
                    xx = row_2;
                    break;
                case 3:
                    xx = row_3;
                    break;
                case 4:
                    xx = row_4;
                    break;

                case 5:
                    xx = row_5;
                    break;
                case 6:
                    xx = row_6;
                    break;

            }

            jq(xx).each(function () {
                var group = jq(this);
                if (class_name.indexOf('Child') == -1) {
                    group.find("input").attr("disabled", disable);

                    if (disable) {
                        /* fade out the fields that are disabled*/
                        group.find("input").fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find("input").fadeTo(250, 1);
                    }
                }
                if (class_name.indexOf('GrandChild') == -1) {
                    /* group.find("input").attr("value", "");*/
                    /* group.find('select').prop("selectedIndex", 0);*/
                    group.find('select').attr("disabled", disable2);

                    if (disable2) {
                        /* fade out the fields that are disabled*/
                        group.find('select').fadeTo(250, 0.25);
                    } else {
                        /* remove the fade on the fields*/
                        group.find('select').fadeTo(250, 1);
                    }
                }
            });
        }



        if (jQuery) {
            jq(document).ready(function () {
                jq("#tabs").tabs();
                if (jq.browser.msie) {
                    jq(":checkbox").click(function () {
                        jq(this).change();
                    });
                }

                /* add JQuery validator classes and rules*/
                jq("#90278 input").addClass("ugphone");

                /* add the validator on the beforeSubmit*/
                beforeSubmit.push(function () {
                            jq("#htmlform").validate();
                            return jq("#htmlform").valid();
                        }
                );

                var gender = jq("span.gender").html();
                var age = jq("span.age").html();

                jq('[class^="FamilyMemberEnableDisable"]').change(function () {
                    enable_disable_fm(jq(this));
                });

                jq('[class^="FamilyMemberEnableDisable"]').each(function () {
                    enable_disable_fm(jq(this));
                });


                jq('[class^="ExposedInfantFinalStatusEnableDisable"]').change(function () {
                    enable_disable_ei_final_status(jq(this));
                });

                jq('[class^="ExposedInfantFinalStatusEnableDisable"]').each(function () {
                    enable_disable_ei_final_status(jq(this));
                });

                jq('[class^="ExposedInfantPCRResultEnableDisable"]').change(function () {
                    enable_disable_ei_pcr_result(jq(this));
                });

                jq('[class^="ExposedInfantPCRResultEnableDisable"]').each(function () {
                    enable_disable_ei_pcr_result(jq(this));
                });


                jq('[class^="ArtCareEnableDisable"]').change(function () {
                    enable_disable_ac(jq(this));
                });


                jq('[class^="ArtCareEnableDisable"]').each(function () {
                    enable_disable_ac(jq(this))
                });

                jq('[class^="HIVCareEnableDisable"]').change(function () {
                    enable_disable_hiv_care(jq(this));
                });

                jq('[class^="ARTCareEntryPointEnableDisable"]').change(function () {
                    enable_disable(jq(this), "ARTCareEntryPoint", 'selected_value == "other"', "select");
                });

                jq('[class^="ARTCareEntryPointEnableDisable"]').each(function () {
                    enable_disable(jq(this), "ARTCareEntryPoint", 'selected_value == "other"', "select");
                });

                jq('[class^="HIVCareEnableDisable"]').each(function () {
                    enable_disable_hiv_care(jq(this))
                });

                jq('[class^="ARTStartEnableDisable"]').change(function () {
                    enable_disable_art_start(jq(this));
                });


                jq('[class^="ARTStartEnableDisable"]').each(function () {
                    enable_disable_art_start(jq(this))
                });


                jq('[class^="ARTStart3EnableDisable"]').change(function () {
                    enable_disable_art_start3(jq(this));
                });


                jq('[class^="ARTStart3EnableDisable"]').each(function () {
                    enable_disable_art_start3(jq(this))
                });


                jq('[class^="ARTTreatmentInterruptionEnableDisable"]').change(function () {
                    enable_disable_ati(jq(this));
                });


                jq('[class^="ARTTreatmentInterruptionEnableDisable"]').each(function () {
                    enable_disable_ati(jq(this))
                });

                jq('[class^="PriorYesNoEnableDisable"]').change(function () {
                    enable_disable(jq(this), "PriorYesNo", 'selected_value == "yes"', "select");
                });

                jq('[class^="PriorYesNoEnableDisable"]').each(function () {
                    enable_disable(jq(this), "PriorYesNo", 'selected_value == "yes"', "select");
                });

                jq("#165143").addClass('hidden');

                jq(".enableDisable").each(function () {
                    var group = jq(this);

                    function disableFn() {
                        group.children("#disabled").fadeTo(250, 0.25);
                        /*  group.children("#disabled").find(":checkbox").attr("checked", false); //uncheck*/
                        group.children("#disabled").find("input").attr("disabled", true);
                        /*disable*/
                        group.children("#disabled").find("select").attr("disabled", true);
                    }

                    function enableFn() {
                        group.children("#disabled").fadeTo(250, 1);
                        group.children("#disabled").find("input").attr("disabled", false);
                        group.children("#disabled").find("select").attr("disabled", false);

                    }

                    if (jq(this).children("#trigger").find(":checkbox:first").attr("checked") != "checked") {
                        disableFn();
                    }

                    jq(this).children("#trigger").find(":checkbox:first").change(function () {
                        var checked = jq(this).attr("checked");
                        if (checked == "checked") {
                            enableFn();
                        } else {
                            disableFn();
                        }
                    });
                });


                jq(".checkboxGroup").each(function () {
                    var group = jq(this);
                    var uncheckAll = function () {
                        group.find("input[type$='checkbox']").attr("checked", false);
                        group.find("input[type$='checkbox']").change();
                    }

                    var uncheckRadioAndAll = function () {
                        group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").attr("checked", false);
                        group.find("#checkboxAll,#checkboxRadio").find("input[type$='checkbox']").change();
                    }


                    group.find("#checkboxAll").find("input").click(
                            function () {
                                var flip;
                                var checked = jq(this).siblings(":checkbox:first").attr("checked");
                                if (jq(this).attr("name") == jq(this).parents("#checkboxAll:first").find(":checkbox:first").attr("name")) {
                                    checked = jq(this).attr("checked");
                                    flip = checked;
                                } else {
                                    flip = !checked;
                                }
                                if (jq.attr("type") == "text") if (flip == false) flip = !filp;
                                /* this is so the user doesn't go to check thecheckbox, then uncheck it when they hit the input.uncheckAll();*/
                                jq(this).parents("#checkboxAll:first").find(":checkbox").attr("checked", flip);
                                jq(this).parents("#checkboxAll:first").find(":checkbox").change();
                            }
                    );


                    group.find("#checkboxRadio").find("input[type$='checkbox']").click(function () {
                        uncheckAll();
                        jq(this).siblings("input[type$='checkbox']").attr("checked", false);
                        jq(this).attr("checked", true);
                        jq(this).change();
                    });

                    group.find("#checkboxCheckbox").click(
                            function () {
                                uncheckRadioAndAll();
                            }
                    );
                });

                var $allTables,
                    $allRows,
                    $otherRows,
                    $firstRow,
                    $thisRow,
                    $nextRow,
                    $hiddenRows,
                    $lastVisibleRow,
                    $nonEmptyBoxes;

                var showAddButtonForLastVisibleRow = function($container) {
                    $lastVisibleRow = $container.find('tr:visible:last');
                    $lastVisibleRow.find('.add').show();
                };

                $firstRow = jq('table.multi tbody tr:first-of-type');
                $otherRows = jq('table.multi tbody tr:not(:first-of-type)');

                jq('.add').click(function(e) { //Handle add button event
                    e.preventDefault();
                    $thisRow = jq(this).parents('tr:first');
                    $nextRow = $thisRow.next();

                    if ($nextRow.length &gt; 0) {
                        $nextRow.show('slow');
                        $thisRow.find('.add').hide();
                    }
                    showAddButtonForLastVisibleRow($thisRow.parents('table:first'));
                });

                jq('.remove').click(function(e) { //Handle remove button event
                    e.preventDefault();
                    $thisRow = jq(this).parents('tr:first');
                    if (confirm('Are you sure you want to remove this record? All fields for this record will be cleared.') == 1) {
                        $thisRow = jq(this).parents('tr:first');
                        $thisRow.hide('slow', function() {
                            showAddButtonForLastVisibleRow($thisRow.parents('table:first'));
                            fieldHelper.clearAllFields($thisRow);
                        });
                    }
                });

            <ifMode mode="ENTER">
                    $otherRows.hide(); //Hide all rows apart from first row if adding new form
                $firstRow.find('.remove').hide(); //Hide the remove button from the first row
            </ifMode>

                <ifMode mode="EDIT">
                //Handle loading of existing obs
                $allTables = jq('table.multi');
                $allTables.each(function() {
                    $allRows = jq(this).find('tbody &gt; tr');
                    $allRows.hide();
                    $nonEmptyBoxes = jq(this).find('tbody tr input[type=text],tbody tr select').filter(function() {
                        return this.value.length &gt; 0;
                    });

                    if ($nonEmptyBoxes.length &gt; 0 ) {
                        $nonEmptyBoxes.each(function() {
                            $thisRow = jq(this).parents('tr:first');
                            $thisRow.show();
                            if ($thisRow.is($firstRow)) {
                                $firstRow.find('.remove').hide();
                            }
                        });

                        if ($nonEmptyBoxes.length == 1) {
                            $nonEmptyBoxes.parents('tr:first').find('.remove').hide(); //Hide the remove button if there is only one visible row
                        }
                    } else {
                        $firstRow.show();
                        $firstRow.find('.remove').hide();
                    }
                });
            </ifMode>
            });

        }
    </script>

    <script type="text/javascript">
        function val() {
            document.getElementById("fgh").disabled = "true";
        }
    </script>

    <style type="text/css">
        .error {
            color: red;
        }

        form#htmlform div.ai-page-frame table tbody td {
            /*background: #B6D6E6;*/
            color: #404040;
            padding: 0px 5px;
        }

        form select, .form select {
            min-width: 0px;
        }

        form input, form select, form textarea, form ul.select, .form input, .form select, .form textarea, .form
        ul.select {
            background-color: #FBFBFB;
            border: 1px solid #404040;
            border-radius: 5px;
            margin-bottom: 10px;
            padding: 10px;
            min-width: 50%;
        }

        .row {
            width: 100%;
            float: left;
            display: inline-flex;
            clear: both;
        }

        .row .row-col2 {
            float: left;
            width: 50%;
        }

        table th, table td {
            /*border: 1px solid #BDBDBD;*/
            text-align: left;
            vertical-align: top;
        }
    </style>

    <!-- Beging of HTML Form -->
    <div class="ai-page-frame">
        <div class="headers" style="text-align: center;">
            <h3>HIV Care/ART CARD - Summary Page</h3>
        </div>
        <div id="tabs">

            <ul>
                <li>
                    <a href="#care-entry-section">
                       Care Entry &amp; Family
                    </a>
                </li>
                <li>
                    <a href="#art-care-cohort-section">
                       ART Care Cohort
                    </a>
                </li>

                <li>
                    <a href="#prior-art-section">
                        Treatment Interruptions
                    </a>
                </li>

                <li>
                    <a href="#drug-allergies-and-art-care">
                        Drug Allergies &amp; ART Care
                    </a>
                </li>

            </ul>
        <section id="care-entry-section">
            <table class="enrollment">
                <tbody>
                <tr>
                    <td>
                        <label><span class="required">*</span>Attending Clinician:</label>
                        <encounterProvider role="Provider" style="autocomplete"/>
                        <span style="display: none;">
                        <encounterLocation default="629d78e9-93e5-43b0-ad8a-48313fd99117"
                                           order="629d78e9-93e5-43b0-ad8a-48313fd99117"/>
                        </span>
                    </td>
                    <td>
                        <includeIf
                                velocityTest="$fn.globalProperty('ugandaemr.showARTPatientNumberIdentifier') == true">
                            <label>ART Patient No.</label>
                            <patient field="identifier" identifierTypeId="3c76abfd-5e2d-4194-b0d4-00b73c7fc1ac"
                                     required="false"/>
                        </includeIf>
                    </td>
                    <td>
                        <label>Pt Clinic #:</label>
                        <patient field="identifier" identifierTypeId="e1731641-30ab-102d-86b0-7a5022ba4115"
                                 required="true"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>HIV Care Transfer in from: </label>
                        <obs conceptId="99109" labelText=""/>
                    </td>
                    <td class="HIVCareEnableDisable1">
                        <label>Date of registration at this site:</label>
                        <encounterDate default="today" disallowMultipleEncountersOnDate="block"/>
                    </td>
                    <td id="comfirmedDate">
                        <label>Date verification HIV test:</label>
                        <obs id="90267" conceptId="90267"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>Test type</label>
                        <obs conceptId="99080" answerConceptIds="99079,99080"
                             answerLabels="Ab,PCR"/>
                    </td>
                    <td>
                        <label>Where</label>
                        <obs conceptId="99081" size="20"/>
                    </td>

                    <td>
                    <includeIf velocityTest="$patient.age &lt; 20 &amp;&amp; $patient.age &gt;=5">
                        <label>In School (5 -19 years):</label>
                        <obs conceptId="5629" answerConceptIds="1065,1066"
                             answerLabels="Yes,No"  style="radio"/>
                    </includeIf>
                    </td>


                </tr>
                <tr>
                    <td>
                        <label>Special Categories</label>

                    </td>
                    <td colspan="3">
                      <span>
                         <obs conceptId="165169" answerConceptId="162277" answerLabel="1 - Prisoners" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="160666" answerLabel="2 - PWIDs" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="165125" answerLabel="3 - Uniformed Men" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="165126" answerLabel="4 - Migrant workers" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="162198" answerLabel="5 - Truckers" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="159674" answerLabel="6 - Fisher Folks" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="165127" answerLabel="7 - Refugees" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="90041" answerLabel="8 - Pregnant" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="99601" answerLabel="9 - Breastfeeding" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="165132" answerLabel="10 - AGYW" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="162558" answerLabel="11 - People with Disabilities (PWD)" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="165224" answerLabel="12 - KP Clinic" style="checkbox" class="horizontal-layout-options" />
                         <obs conceptId="165169" answerConceptId="90002" answerLabel="13 - Others (specify)" style="checkbox" class="horizontal-layout-options" />
                       </span>

                        <span>
                            <obs id="165184" conceptId="165184" class="horizontal-layout-options"/>
                        </span>
                    </td>
                </tr>
                <tr style="background: #F7F7F7;">
                    <obsgroup groupingConceptId="99116">
                        <td style="width: 33%;">
                            <label>Care Entry Point</label>

                            <span class="ARTCareEntryPointEnableDisable1">
                                        <obs conceptId="90200"
                                             answerConceptIds="90012,90016,99593,99610,90019,90013,90015,90018,90002"
                                             answerLabels="eMTCT,TB,YCC,SMC,Outreach,Out Patient,STI,Inpatient,Other"
                                             required="true"/>
                                </span>
                        </td>
                        <td style="width: 33%;" colspan="2">
                            <label>Other</label>
                            <span class="ARTCareEntryPointEnableDisableChild1">
                                <obs conceptId="99115" labelText=""/>
                            </span>
                        </td>
                    </obsgroup>
                </tr>
                </tbody>
            </table>
            <h3>Treatment Supporter</h3>
            <table>
                <tbody>
                <tr>
                    <td colspan="2">
                        <label>Medicine pick-up if ill:</label>
                        <obs size="15" conceptId="99142"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>Relationship to index clients</label>
                        <obs conceptId="99725" answerConceptIds="90286,90280,90288,90284,90279,5618,90002"
                             answerLabels="Cousin,Child,Partner/Spouse,GrandChild,Parent,Friend,Other"/>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label>Telephone</label>
                        <obs conceptId="90278" size="12" class="ugphone" id="90278"/>
                        <br/>
                        <label>whose</label>
                        <obs conceptId="99118"/>
                    </td>
                </tr>
                </tbody>
            </table>
        </section>
        <section id="art-care-cohort-section">
        <section>
            <h3>ART Care Start</h3>
            <section>
            <table border="0" id="art-care">
                <tbody style="display:block;">
                <tr>
                    <obsgroup groupingConceptId="99162">
                        <td rowspan="3" style="width:10%;" class="ARTStartEnableDisable1">
                            <obs id="99161" conceptId="99161" labelText="At Start ART:"/>
                        </td>
                        <td rowspan="3" class="ARTStartEnableDisableChild1" style="width:10%;">
                            <span class="ArtCareEnableDisable2">
                            <obs conceptId="99061"
                                 answerConceptIds="99005,99006,164979,99015,99016,99039,99040,164977,99041,99042,99884,99885,164978,163017,99143"
                                 answerLabels="AZT-3TC-NVP, AZT-3TC-EFV,AZT-3TC-DTG, D4T-3TC-NVP, D4T-3TC-EFV, TDF-3TC-NVP, TDF-3TC-EFV, TDF-3TC-DTG, TDF-FTC-NVP, TDF-FTC-EFV,ABC-3TC-NVP,ABC-3TC-EFV,ABC-3TC-DTG,ABC-3TC-LPV/r,OTHER"
                                 labelText="Start ART 1st Line Initial Regimen"/>
                                </span>
                            <span class="ArtCareEnableDisableChild2">
                                <obs conceptId="99268" labelText="Others"/>
                            </span>
                        </td>
                    </obsgroup>
                    <td style="width:20%;" class="ARTStartEnableDisableChild1">
                        <obs conceptId="99069" labelText="Wt"/>
                    </td>
                    <td style="width:20%;" class="ARTStartEnableDisableChild1">
                        <obs conceptId="99070" answerConceptIds="1204,1205,1206,1207"
                             answerLabels="1,2,3,4" labelText="CI.Stage" style="dropdown"/>
                    </td>
                </tr>
                <tr>
                    <td class="ARTStartEnableDisableChild1">
                        <obs conceptId="99071" labelText="CD4"/>
                    </td>
                    <td class="ARTStartEnableDisableChild1">
                        <excludeIf velocityTest="$patient.gender =='M' ">
                            <obs conceptId="99072" answerConceptIds="90003,90004"
                                 answerLabels="Y, N" labelText="Preg"/>
                        </excludeIf>
                    </td>
                </tr>
                <tr>
                    <td class="ARTStartEnableDisableChild1">
                        <excludeIf velocityTest="$patient.gender =='M' ">
                            <obs conceptId="99603" answerConceptIds="90003,90004"
                                 answerLabels="Y, N" labelText="Lactating"/>
                        </excludeIf>
                    </td>
                    <td></td>
                </tr>
                </tbody>
            </table>
            </section>
            <section>
                <h4>ART Transfer In</h4>
          <table class="multi">
            <tbody>
            <repeat>
                <template>
                    <obsgroup groupingConceptId="99065">
                        <tr>
                            <td class="ARTStartEnableDisable2">
                                <obs id="99160" conceptId="99160" labelText="Date transfered:"/>
                            </td>
                            <td class="ARTStartEnableDisableChild2">
                                <obs conceptId="90206" size="20" labelText="Transfered from:"/>
                            </td>
                            <td colspan="2" class="ARTStartEnableDisableChild2">
                                <span class="ArtCareEnableDisable1">
                                <small>
                                    <obs labelText="ARVs" conceptId="99064"
                                         answerConceptIds="99015,99016,99005,99006,164979,99039,99040,99041,99042,164977,99007,99008,99044,99043,99282,99283,99046,99017,99018,99019,99045,99284,99285,99286,99046,164978,163017,90002"
                                         answerLabels="d4T-3TC-NVP,d4T-3TC-EFV,AZT-3TC-NVP,AZT-3TC-EFV,AZT-3TC-DTG,TDF-3TC-NVP,TDF-3TC-EFV,TDF-FTC-NVP,TDF-FTC-EFV,TDF-3TC-DTG,ABC-ddI(250)-LPV/r,ABC-ddI(400)-LPV/r,TDF-3TC-LPV/r,TDF-FTC-LPV/r,ZDV-ddI(250)-LPV/r,ZDV-ddI(400)-LPV/r,ZDV-3TC-LPV/r,ABC-ddI-LPV/r,ABC-ddI-NFV,ABC-ddI-SQV/r,ZDV-ddI-LPV/r,ZDV-ABC-LPV/r,ABC-ddI-ATV/r,AZT-3TC-ATV/r,AZT-3TC-LPV/r,ABC-3TC-DTG,ABC-3TC-LPV/r,Other"/>
                                </small>
                                    </span>
                                <span class="ArtCareEnableDisableChild1">
                                    <obs conceptId="99269" size="12" labelText="Other:"/>
                                </span>

                            </td>
                            <td></td>
                            <td align="center">
                                <a href="#" class="add">Add</a> | <a href="#" class="remove">Remove</a>
                            </td>
                        </tr>
                    </obsgroup>
                </template>
                <render/>
                <render/>
                <render/>
                <render/>
                <render/>
            </repeat>

            </tbody>
          </table>
            </section>
            <section>
                <h4>Substitutions</h4>
                <h5 style="background: #404040; color: white;">Substitution within 1st line</h5>
            <table class="multi">
                <tbody>
                <repeat>
                    <template>
                    <obsgroup groupingConceptId="99062">
                        <tr>
                        <td class="ARTStartEnableDisable3">
                            <label>Date</label>
                            <obs id="99163_1" conceptId="99163"/>
                        </td>
                        <td class="ARTStartEnableDisableChild3">
                            <label>New Regimen</label>
                            <span class="ArtCareEnableDisable3">
                            <obs conceptId="90315"
                                 answerConceptIds="99015,99016,99005,99006,164979,99039,99040,99041,99042,164977,99884,99885,164978,163017,99143"
                                 answerLabels="d4T-3TC-NVP,d4T-3TC-EFV,AZT-3TC-NVP,AZT-3TC-EFV,AZT-3TC-DTG,TDF-3TC-NVP,TDF-3TC-EFV,TDF-FTC-NVP,TDF-FTC-EFV,TDF-3TC-DTG,ABC-3TC-NVP,ABC-3TC-EFV,ABC-3TC-DTG,ABC-3CT-LPV/r,Other"/>
                            </span>
                            <span class="ArtCareEnableDisableChild3">
                                <obs size="20" conceptId="99146" labelText="Other"/>
                            </span>
                        </td>
                        <td colspan="2" class="ARTStartEnableDisableChild3">
                            <label>Why</label>
                            <obs conceptId="90246" answerConceptIds="90040,90043,90044,90045,90002"
                                 answerLabels="1.Toxi,2.NewTB,3.NewDrug,4.Drug Stock,5.Other"/>
                        </td>
                            <td align="center">
                                <a href="#" class="add">Add</a> | <a href="#" class="remove">Remove</a>
                            </td>
                        </tr>
                    </obsgroup>
                    </template>
                    <render/>
                    <render/>
                    <render/>
                    <render/>
                    <render/>
                </repeat>
                </tbody>
            </table>
            </section>
            <section>
                <h5 style="background-color: #377F9C;color: white;">Switch to 2nd
                    Line or Substitution within 2nd Line
                </h5>
                <table class="multi">
                    <tbody>
                    <repeat>
                        <template>
                            <obsgroup groupingConceptId="99063">
                                <tr>
                                <td class="ARTStartEnableDisable7">
                                    <label>Date</label>
                                    <obs id="99164_1" conceptId="99164"/>
                                </td>
                                <td class="ARTStartEnableDisableChild7">
                                    <label>New Regimen</label>
                                <span class="ArtCareEnableDisable7">
                                    <small>
                                        <obs conceptId="90315"
                                             answerConceptIds="99007,99008,99044,99043,99282,99283,99046,99017,99018,99019,99045,99284,99285,99286,99046,99046,99887,99888,99144"
                                             answerLabels="ABC-ddI(250)-LPV/r,ABC-ddI(400)-LPV/r,TDF-3TC-LPV/r,TDF-FTC-LPV/r,ZDV-ddI(250)-LPV/r,ZDV-ddI(400)-LPV/r,ZDV-3TC-LPV/r,ABC-ddI-LPV/r,ABC-ddI-NFV,ABC-ddI-SQV/r,ZDV-ddI-LPV/r,ZDV-ABC-LPV/r,ABC-ddI-ATV/r,AZT-3TC-ATV/r,AZT-3TC-LPV/r,TDF-3TC-ATV/r,ABC-3TC-ATV/r,Other"/>
                                    </small>
                                    </span>
                                    <span class="ArtCareEnableDisableChild7">
                                        <obs size="20" conceptId="99147" labelText="Other"/>
                                    </span>
                                </td>
                                <td colspan="2" class="ArtCareEnableDisableChild7">
                                    <label>Why</label>
                                    <obs conceptId="90247" answerConceptIds="90046,90047,99889"
                                         answerLabels="6.Clinical, 7.Immuno, 8. Virological"/>
                                </td>
                                <td align="center">
                                    <a href="#" class="add">Add</a> | <a href="#" class="remove">Remove</a>
                                </td>
                                </tr>
                            </obsgroup>
                        </template>
                        <render/>
                        <render/>
                        <render/>
                        <render/>
                        <render/>
                    </repeat>
                    </tbody>
                </table>
            </section>
            <section>
                <h5 style="background-color: #377F9C;color: white;">Switch to 3rd line Or Substitution with 3rd Line </h5>
             <table class="multi">
               <tbody>
                <repeat>
                    <template>
                        <obsgroup groupingConceptId="162988">
                        <tr>
                        <td class="ARTStart3EnableDisable1">
                            <label>Date</label>
                            <obs id="162991_1" conceptId="162991"/>
                        </td>
                        <td class="ARTStart3EnableDisableChild1">
                            <label>New Regimen</label>
                            <span class="ArtCareEnableDisable10">
                                <small>
                                    <obs conceptId="162990"/>
                                </small>
                            </span>
                            <span class="ArtCareEnableDisableChild10">
                                <obs size="20" conceptId="162989" labelText="Other"/>
                            </span>
                        </td>
                        <td colspan="2" class="ARTStart3EnableDisableChild1">
                            <label>Why</label>
                            <obs conceptId="90247" answerConceptIds="90046,90047,99889"
                                 answerLabels="6.Clinical, 7.Immuno, 8. Virological"/>
                        </td>
                        <td align="center">
                            <a href="#" class="add">Add</a> | <a href="#" class="remove">Remove</a>
                        </td>
                        </tr>
                    </obsgroup>
                    </template>
                    <render/>
                    <render/>
                    <render/>
                    <render/>
                </repeat>
                </tbody>
            </table>
            </section>
        </section>
            <section>
                <h3>Prior ART</h3>
                <table border="0" id="art-history" style="background-color: #EEE">
                    <tbody>
                    <tr style="background: beige;">
                        <td>

                        </td>
                        <td colspan="3" class="PriorYesNoEnableDisable1">
                            <label><b>Prior ARV/ART</b></label>
                            <obs conceptId="99055" answerConceptIds="90003,90004"
                                 answerLabels="Yes,No" style=" radio"/>
                        </td>
                    </tr>
                    <tr>
                        <td>

                        </td>
                        <td>
                            <b>Start Date</b>
                        </td>

                        <td>
                            <b>Duration in Months</b>
                        </td>
                    </tr>
                    <tr class="enableDisable">
                        <obsgroup groupingConceptId="99066">
                            <td id="trigger" class="PriorYesNoEnableDisableChild1">
                                <obs conceptId="99056" answerConceptId="90003" answerLabel="PEP:"
                                />
                            </td>
                            <td id="disabled">
                                <obs id="second" conceptId="99154" labelText=""/>
                            </td>
                            <td id="disabled">
                                <obs id="third" conceptId="99057"/>
                            </td>
                            <td id="disabled">
                                <obs id="fourth" conceptId="99130"
                                     answerConceptIds="630,99276,99275,99277,99278,99279,99006,99016,99046,99280,99281,90002"
                                     answerLabels="AZT-3TC, AZT-FTC, TDF-3TC, TDF-FTC, d4T-3TC, d4T-FTC,AZT-3TC-EFV,D4T-3TC-EFV,AZT-3TC-LPV/r,AZT-3TC-NFV,d4T-3TC-LPV/r, Other"/>
                            </td>
                        </obsgroup>
                    </tr>
                    <tr class="enableDisable">
                        <obsgroup groupingConceptId="99598">
                            <td id="trigger" class="PriorYesNoEnableDisableChild1">
                                <obs conceptId="99594" answerConceptId="90003" answerLabel="Hep-B:"/>
                            </td>
                            <td id="disabled">
                                <obs id="second" conceptId="99595" labelText=""/>
                            </td>
                            <td id="disabled">
                                <obs id="third" conceptId="99596"/>
                            </td>
                            <td id="disabled">
                                <obs id="fourth" conceptId="99597"
                                     answerConceptIds="630,99276,99275,99277,99278,99279,99006,99016,99046,99280,99281,90002"
                                     answerLabels="AZT-3TC, AZT-FTC, TDF-3TC, TDF-FTC, d4T-3TC, d4T-FTC,AZT-3TC-EFV,D4T-3TC-EFV,AZT-3TC-LPV/r,AZT-3TC-NFV,d4T-3TC-LPV/r, Other"/>
                            </td>
                        </obsgroup>
                    </tr>
                    <excludeIf velocityTest="$patient.gender =='M' ">
                        <tr class="enableDisable">
                            <obsgroup groupingConceptId="99067">
                                <td id="trigger" class="PriorYesNoEnableDisableChild1">
                                    <obs conceptId="90012" answerConceptId="90003"
                                         answerLabel="PMTCT Only:"/>
                                </td>
                                <td id="disabled">
                                    <obs id="second" conceptId="99155" labelText=""/>
                                </td>
                                <td id="disabled">
                                    <obs id="third" conceptId="99058"/>
                                </td>
                                <td id="disabled">
                                    <obs id="fourth" conceptId="99131"
                                         answerConceptIds="631,97,628,630,99005,99006,99039,99040,99041,99042,90002"
                                         answerLabels="NVP, AZT,3TC, AZT-3TC, AZT-3TC-NVP,AZT-3TC-EFV,TDF-3TC-NVP, TDF-3TC-EFV,TDF-FTC-NVP,TDF-FTC-EFV,Other"/>
                                </td>
                            </obsgroup>
                        </tr>
                    </excludeIf>
                    <tr class="enableDisable">
                        <obsgroup groupingConceptId="99068">
                            <td id="trigger" class="PriorYesNoEnableDisableChild1">
                                <obs conceptId="99059" answerConceptId="90003"
                                     answerLabel="Earlier ARV not transfer:"/>
                            </td>
                            <td id="disabled">
                                <obs id="second" conceptId="99156" labelText=""/>
                            </td>
                            <td id="disabled">
                                <obs id="third" conceptId="99060"/>
                            </td>
                            <td id="disabled">
                                <obs id="fourth" conceptId="99129"
                                     answerConceptIds="99015,99016,99005,99006,99039,99040,99041,99042,99007,99008,99044,99043,99282,99283,99046,99017,99018,99019,99045,99284,99285,99286,90002"
                                     answerLabels="d4T-3TC-NVP,d4T-3TC-EFV,AZT-3TC-NVP,AZT-3TC-EFV,TDF-3TC-NVP,TDF-3TC-EFV,TDF-FTC-NVP,TDF-FTC-EFV,ABC-ddI(250)-LPV/r,ABC-ddI(400)-LPV/r,TDF-3TC-LPV/r,TDF-FTC-LPV/r,ZDV-ddI(250)-LPV/r,ZDV-ddI(400)-LPV/r,ZDV-3TC-LPV/r,ABC-ddI-LPV/r,ABC-ddI-NFV,ABC-ddI-SQV/r,ZDV-ddI-LPV/r,ZDV-ABC-LPV/r,ABC-ddI-ATV/r,ZDV-3TC-ATV/r,Other"/>
                            </td>
                        </obsgroup>
                    </tr>
                    </tbody>
                </table>
            </section>
        </section>
        <section id="prior-art-section">
            <section>
                <h3>ART/TPT/Fluconazole/ TB  Interruptions </h3>
                <table class="multi">
                    <tbody>
                        <repeat>
                            <template>
                                <obsgroup groupingConceptId="165232">
                                    <tr>
                                        <td>

                                            <label>
                                                <b>Treatment type</b>
                                            </label>

                                            <div class="ARTTreatmentInterruptionEnableDisable1">
                                                <obs conceptId="165228" answerConceptIds="99132,165225,747,58"
                                                     answerLabels="ART,TPT,Fluconazole,TB Drugs"/>
                                            </div>
                                        </td>
                                        <td>
                                            <label>
                                                <b>Interruption (Stop/Lost)</b>
                                            </label>
                                            <span class="ARTTreatmentInterruptionEnableDisable2">
                                                        <obs conceptId="165229" answerConceptIds="1363,99133"
                                                             answerLabels="Stopped,  Lost"/>
                                                    </span>
                                        </td>
                                        <td>
                                            <div>
                                                <b>Stop Date</b>
                                                <br/>
                                                <obs conceptId="165230"/>
                                                <br/>
                                            </div>
                                        </td>
                                        <td>
                                            <div>
                                                <b>Why</b>
                                                <br/>

                                                <obs conceptId="165231" labelText=""
                                                     answerConceptIds="90040,90046,90158,90050,90045,90051,90052,90066,99289,90002"
                                                     answerLabels="1.Toxicity/side effects,2.Treatment Failure,3. Poor Adherence, 4.Illness/hospitalization, 5.Drug out of stock, 6.Patient lacks Finances, 7. Other patient decision, 8.Patient Rx interruption intpn, 9.Excluded HIV Infection, 10.Other,"/>
                                            </div>
                                        </td>
                                        <td>
                                            <div>
                                                <br/>
                                                <b>Date if Restart/Re-activated</b>
                                                <br/>
                                                <obs conceptId="160738"/>
                                            </div>

                                        </td>
                                        <td align="center">
                                            <a href="#" class="add">Add</a> | <a href="#" class="remove">Remove</a>
                                        </td>
                                    </tr>
                                </obsgroup>
                            </template>
                            <render />
                            <render />
                            <render />
                            <render />
                            <render />
                            <render />
                        </repeat>
                    </tbody>
                </table>
            </section>
        <section>
            <h3>Interruptions &amp; Outcomes</h3>
            <table border="0" id="art-care"
                   style="padding: 10px; margin: 5px; border: solid 1px #D2D2D2;">
                <tbody>
                <tr>
                    <td style="color: #404040; background-color: #F3F3F3">Status</td>
                    <td style="color: #404040; background-color: #F3F3F3">Date</td>
                    <td style="color: #404040; background-color: #F3F3F3"></td>
                </tr>
                <tr class="enableDisable">
                    <obsgroup groupingConceptId="99166">
                        <td id="trigger">
                            <obs id="90306" conceptId="90306" answerConceptId="90003"
                                 answerLabel="Transfer out:"/>
                        </td>
                        <td id="disabled">
                            <obs id="99165" conceptId="99165"/>
                        </td>
                        <td id="disabled">
                            <obs conceptId="90211" labelText="Where"/>
                        </td>
                    </obsgroup>
                </tr>
                <tr class="enableDisable">
                    <obsgroup groupingConceptId="99167">
                        <td id="trigger">
                            <obs id="5240" conceptId="5240" answerConceptId="90003"
                                 answerLabel="Lost to follow-up (drop):"/>
                        </td>
                        <td id="disabled">
                            <obs id="90209" conceptId="90209"/>
                        </td>
                        <td></td>
                    </obsgroup>
                </tr>
                </tbody>
            </table>
        </section>
        </section>
        <section id="drug-allergies-and-art-care">
        <section>
            <section>
            <div class="row">
                <div class="row-col12">
                    <h5>TPT INITIATION/COMPLETION DATES</h5>
                </div>
            </div>
            <div class="row section  ui-widget-content ui-corner-bottom">
                    <div class="row-col2">
                        <label>Date TPT started: </label>
                        <obs conceptId="165226"/>
                    </div>
                    <div class="row-col2">
                       <label>Date TPT Completed: </label>
                        <obs conceptId="165227"/>
                    </div>
            </div>
            </section>
            <div class="row">
                <div class="row-col2">
                    <section>
                        <h3>Drug allergies</h3>
                        <table style="border:0;">
                            <tbody>
                            <tr>
                                <td>
                                    <obsgroup groupingConceptId="90230">
                                        <label class="label">1</label>
                                        <obs conceptId="142" size="30"/>
                                        <br/>
                                        <label>2</label>
                                        <obs conceptId="142" size="30"/>
                                        <br/>
                                        <label>3</label>
                                        <obs conceptId="142" size="30"/>
                                        <br/>
                                        <label>4</label>
                                        <obs conceptId="142" size="30"/>
                                        <br/>
                                        <label>5</label>
                                        <obs conceptId="142" size="30"/>
                                    </obsgroup>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </section>
                </div>
                <div class="row-col2">
                    <section>
                        <h3>Relevant medical conditions</h3>
                        <table>
                            <tbody>
                            <tr>
                                <td>
                                    <obsgroup groupingConceptId="99104">
                                        <label>1</label>
                                        <obs conceptId="99111" size="30"/>
                                        <br/>
                                        <label>2</label>
                                        <obs conceptId="99111" size="30"/>
                                        <br/>
                                        <label>3</label>
                                        <obs conceptId="99111" size="30"/>
                                        <br/>
                                        <label>4</label>
                                        <obs conceptId="99111" size="30"/>
                                        <br/>

                                        <label>5</label>
                                        <obs conceptId="99111" size="30"/>
                                    </obsgroup>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </section>
                </div>
            </div>
        </section>
        </section>
     </div>
    <postSubmissionAction class="org.openmrs.module.aijar.htmlformentry.DSDSProgramSubmissionAction"/>
    <section>
        <submit/>
    </section>
    </div>
    <!-- End of HTML Form -->
    <ifMode mode="EDIT" include="false">
        <lookup complexExpression="
            #set( $encounter = 0 )
            #set( $encounter = $fn.latestEncounter('8d5b27bc-c2cc-11de-8d13-0010c6dffd0f'))
            #if( $encounter != 0 )
                &lt;script type=&quot;text/javascript&quot;>
                        if (window.location.href.indexOf('/module/htmlformentry/htmlForm.form') == -1) {
                            window.location.href = window.location.protocol + &quot;//&quot; + window.location.host + &quot;/&quot;+ OPENMRS_CONTEXT_PATH + &quot;/htmlformentryui/htmlform/editHtmlFormWithStandardUi.page?visitId=$encounter.visit.visitId&amp;formUuid=52653a60-8300-4c13-be4d-4b746da06fee&amp;patientId=$patient.patientId&amp;encounterId=$encounter.encounterId&amp;returnUrl=%2F&quot; + OPENMRS_CONTEXT_PATH + &quot;%2Fcoreapps%2Fclinicianfacing%2Fpatient.page%3FpatientId%3D$patient.patientId&quot;;
                        }
                &lt;/script>
            #end"/>
    </ifMode>
</htmlform>